<!DOCTYPE html>
<html>
    <body>
    <div id="player"></div>
    <script>
		var debug = typeof Holder === 'undefined';
		var initialID = getURLParameter('id') || 'DR91Rj1ZN1M';

                debug || Holder.onWVReady();
                var tag = document.createElement('script');
                tag.src = "https://www.youtube.com/iframe_api";
                var firstScriptTag = document.getElementsByTagName('script')[0];
                firstScriptTag.parentNode.insertBefore(tag, firstScriptTag);

                var player;
                function onYouTubeIframeAPIReady() {
                    player = new YT.Player('player', {
                        height: '200',
                        width: '200',
			playerVars: {
				loop: 1,
				playlist: initialID,
                        	start: getURLParameter('start') || '0',
			},
                        videoId: initialID,
                        origin: 'http://www.youtube.com',
                        events: {
                            'onReady': onPlayerReady,
                            'onStateChange': onPlayerStateChange
                        }
                    });
                    debug || WebView.onInitialized();
                }

                function onPlayerReady(event) {
		    event.target.setPlaybackQuality('small');
                    debug || Holder.onYTCued();
                }

		function prepVideo(id, start) {
		    player.cuePlaylist(id, 0, start, 'small');
		    player.setLoop(true);
		    player.setPlaybackQuality('small');
		}

                function onPlayerStateChange(event) {
		    //console.log('STATE CHANGE: ' + event.data);
		    if (event.data == YT.PlayerState.CUED) {
			debug || Holder.onYTCued();
		    } else if (event.data == YT.PlayerState.PLAYING) {
                        debug || Holder.onYTPlay();
		    } else if (event.data == YT.PlayerState.BUFFERING ||
			       event.data == YT.PlayerState.PAUSED) {
                        debug || Holder.onYTPause();
		    }
                }

                function getURLParameter(name) {
                    return decodeURIComponent((new RegExp('[?|&]' + name + '=' + '([^&;]+?)(&|#|;|$)').exec(location.search)||[,""])[1].replace(/\+/g, '%20'))||null;
                }
        </script>
    </body>
</html>
